name: "Deploy Prometheus Node Exporter on GH cluster"
description: "Deploys and exposes Prometheus Node Exporter on GH cluster"
runs:
  using: "composite"
  steps:
    - name: Install Prometheus Node exporter
      shell: bash
      run: |
        helm repo add prometheus-community https://prometheus-community.github.io/helm-charts
        helm repo update
        kubectl create namespace prometheus-node-exporter
        helm install prometheus-node-exporter prometheus-community/prometheus-node-exporter --namespace prometheus-node-exporter
        
        # Wait until the node exporter is up and running
        kubectl wait --for=condition=available --timeout=600s deployment/prometheus-node-exporter